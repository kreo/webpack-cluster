<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: ConfigBuilder.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: ConfigBuilder.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {
    has,
    set
} from 'lodash';
import Config from 'webpack-config';
import {
    supportsColor
} from 'chalk';
import STATS_OPTIONS from './StatsOptions';
import CONFIG_HOOKS from './ConfigHooks';

/**
 * @private
 * @type {Boolean}
 */
const SUPPORTS_COLOR = supportsColor !== false;

/**
 * @private
 * @type {WeakMap}
 */
const CONFIG = new WeakMap();

/**
 * @private
 * @type {WeakMap}
 */
const HOOKS = new WeakMap();

/**
 * @class
 */
class ConfigBuilder {
    /**
     * @constructor
     * @param {Config|ConfigList} [config]
     * @param {Object&lt;String,Function>} [hooks]
     */
    constructor(config, hooks = CONFIG_HOOKS) {
        if (!config) {
            config = new Config();
        }

        CONFIG.set(this, config);
        HOOKS.set(this, hooks);
    }

    /**
     * @readonly
     * @type {Config|ConfigList}
     */
    get config() {
        return CONFIG.get(this);
    }

    /**
     * @readonly
     * @type {Object&lt;String,Function>}
     */
    get hooks() {
        return HOOKS.get(this);
    }

    /**
     * @param {Object} options
     * @returns {ConfigBuilder}
     */
    merge(options) {
        this.pendingConfig.merge(options);

        return this;
    }

    /**
     * @param {Object} options
     * @returns {ConfigBuilder}
     */
    defaults(options) {
        this.pendingConfig.defaults(options);

        return this;
    }

    /**
     * @param {Object} [stats]
     * @returns {ConfigBuilder}
     */
    stats(stats = STATS_OPTIONS) {
        return this.defaults({
            stats: stats
        });
    }

    /**
     * @param {Boolean} [colors]
     * @returns {ConfigBuilder}
     */
    colors(colors = SUPPORTS_COLOR) {
        return this.merge({
            stats: {
                colors: colors
            }
        });
    }

    /**
     * @param {String} pattern
     * @returns {ConfigBuilder}
     */
    pattern(pattern) {
        return this.merge({
            resolve: {
                pattern: pattern
            }
        });
    }

    /**
     * @returns {ConfigBuilder}
     */
    reset() {
        if (this.pendingConfig) {
            delete this.pendingConfig;
        }

        this.pendingConfig = new Config();

        return this;
    }

    /**
     * @returns {ConfigBuilder}
     */
    applyHooks() {
        for (const [path, hook] of Object.entries(this.hooks)) {
            if (has(this.pendingConfig, path)) {
                const value = hook(path, this.pendingConfig, this.config);

                set(this.pendingConfig, path, value);
            }
        }

        return this;
    }

    /**
     * @returns {Object|Object[]}
     */
    build() {
        let config;

        if (Array.isArray(this.config)) {
            config = this.config.map(x => x.clone().merge(this.pendingConfig).toObject());
        } else {
            config = this.config.clone().merge(this.pendingConfig).toObject();
        }

        this.reset();

        return config;
    }
}

export default ConfigBuilder;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-webpack-glob.html">webpack-glob</a></li></ul><h3>Classes</h3><ul><li><a href="ClusterCompilerStrategy.html">ClusterCompilerStrategy</a></li><li><a href="ClusterForkRunStrategy.html">ClusterForkRunStrategy</a></li><li><a href="ClusterForkWatchStrategy.html">ClusterForkWatchStrategy</a></li><li><a href="ClusterRunStrategy.html">ClusterRunStrategy</a></li><li><a href="ClusterWatchStrategy.html">ClusterWatchStrategy</a></li><li><a href="CompilerAdapter.html">CompilerAdapter</a></li><li><a href="CompilerFactory.html">CompilerFactory</a></li><li><a href="CompilerStrategy.html">CompilerStrategy</a></li><li><a href="CompilerStrategyError.html">CompilerStrategyError</a></li><li><a href="CompilerStrategyEventsFactory.html">CompilerStrategyEventsFactory</a></li><li><a href="CompilerStrategyInvoker.html">CompilerStrategyInvoker</a></li><li><a href="CompilerStrategyProgress.html">CompilerStrategyProgress</a></li><li><a href="CompilerStrategyResult.html">CompilerStrategyResult</a></li><li><a href="CompilerStrategyStats.html">CompilerStrategyStats</a></li><li><a href="ConfigBuilder.html">ConfigBuilder</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed Jun 01 2016 07:22:35 GMT+0000 (UTC)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
